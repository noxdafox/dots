#!/bin/bash

PROJECTS=$HOME/development/

# add scripts to Guile load path
GUILE_LOAD_PATH=${GUILE_LOAD_PATH}:~/development/spells/guile

# add Python projects to PYTHONPATH
exclude_regex=".*(doc|test|build|debian|python|example).*"
## /project/package/__init__.py
stdpkg_regex="^$PROJECTS\/?([^\/]+\/){2,2}__init__.py$"
## /project/(src|lib)/package/__init__.py
srcpkg_regex="^$PROJECTS\/?[^\/]+\/(src|lib)\/[^\/]+\/__init__.py$"

for package in $(find $PROJECTS -regextype posix-extended \
                      \( -regex $stdpkg_regex -o -regex $srcpkg_regex \) \
                      -a ! -regex $exclude)
do
    export PYTHONPATH=${PYTHONPATH}:${package%/*/*}
done

# enable colors inside Emacs shell
if [ "$INSIDE_EMACS" ]; then
    export TERM=ansi COLORTERM=1
fi
